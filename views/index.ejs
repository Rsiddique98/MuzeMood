<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MuzeMood</title>
    <link rel="stylesheet" href="/styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
</head>
<body>
<!-- Homepage background-->
    <div class="animated-bg"></div> 

<!-- Navbar -->
 <%- include("header.ejs") %>    

<!-- Hero Section -->
<header class="hero">
    <div class="hero-content">
        <h1>Feel the Vibe, Hear the Sound.</h1>
        <p>Elevate your music taste with MuzeMood.</p>
        <a href="#" id="listen-now-btn" class="btn btn-gradient">Listen now</a>
    </div>
    <div class="hero-image">
        <img src="/images/headphonegirl.png" alt="Headphone Girl">
    </div>
</header>

<!-- Playlist Mood Selection Section -->
<section id="playlist-moods">
    <h2>How are you feeling today?</h2>

    <div class="mood-grid">
        <% Object.keys(playlistCovers).forEach(mood => { %>
            <div class="mood-item" onclick="loadPlaylist('<%= mood %>')">
                <img src="<%= playlistCovers[mood] %>" alt="<%= mood %> Playlist Cover">
                <h3><%= mood.charAt(0).toUpperCase() + mood.slice(1) %></h3>
            </div>
        <% }); %>
    </div>
</section>

 <!-- ðŸŽ§ Music Player Section (Initially Hidden) -->
 <section id="music-player-container" >
    <div id="playlist-content"></div>
</section>

<!-- ðŸŽ¼ JavaScript to Fetch Playlist Dynamically -->
<script>
    function loadPlaylist(mood) {
        const animatedBg = document.querySelector('.animated-bg');

          // Add the new mood class based on the selected mood
    if (mood === 'sad') {
        animatedBg.classList.add('sad');
    } else if (mood === 'energetic') {
        animatedBg.classList.add('energetic');
    } else if (mood === 'chill') {
        animatedBg.classList.add('chill');
    } else if (mood === 'happy') {
        animatedBg.classList.add('happy');
    }

    fetch(`/playlist/${mood}`)
            .then(response => response.text())  // Fetch raw HTML
            .then(html => {
                document.getElementById("playlist-content").innerHTML = html;
                document.getElementById("music-player-container").style.display = "block";

                // âœ… Reinitialize Swiper after the playlist is loaded
                setTimeout(() => {
                    new Swiper('.swiper', {
                        slidesPerView: 1,
                        spaceBetween: 20,
                        loop: true,
                        centeredSlides: true, // Ensure the active slide is always centered
                        navigation: {
                            nextEl: '.swiper-button-next',
                            prevEl: '.swiper-button-prev',
                        },
                        pagination: {
                            el: '.swiper-pagination',
                            clickable: true,
                        },
                    });
                }, 500); // Delay to ensure the content is loaded
            })
            .catch(error => console.error("Error loading playlist:", error));
    }

     // âœ… Smooth scroll for "Listen Now", "Playlists" and Play icon button
     document.addEventListener("DOMContentLoaded", function () {
        const listenNowBtn = document.getElementById("listen-now-btn");
        const playlistsBtn = document.getElementById("playlists-btn");
        const playBtn = document.getElementById("play-btn");
        const musicPlayerContainer = document.getElementById("music-player-container");

        function scrollToMusicPlayer(event) {
            event.preventDefault(); // Prevent default anchor behavior
            musicPlayerContainer.scrollIntoView({ behavior: "smooth" });
        }

        // Add event listeners if the elements exist
        if (listenNowBtn) {
            listenNowBtn.addEventListener("click", scrollToMusicPlayer);
        }
        if (playlistsBtn) {
            playlistsBtn.addEventListener("click", scrollToMusicPlayer);
        }
        if (playBtn) {
            playBtn.addEventListener("click", scrollToMusicPlayer);
        }
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<!-- Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
</body>
</html>